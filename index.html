<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Practicing</title>
    <style>
        :root {
            --primary: #2563eb; --secondary: #1e40af; --bg: #f8fafc;
            --text: #334155; --correct: #16a34a; --wrong: #dc2626; --warning: #f59e0b;
        }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); color: var(--text); }
        header { background: var(--primary); color: white; padding: 20px; text-align: center; }
        nav { display: flex; justify-content: center; background: var(--secondary); position: sticky; top: 0; z-index: 100; overflow-x: auto; }
        nav button { background: none; border: none; color: white; padding: 15px 20px; cursor: pointer; font-weight: 600; transition: 0.3s; }
        nav button:hover, nav button.active { background: rgba(255,255,255,0.2); }
        main { max-width: 1100px; margin: 20px auto; padding: 20px; }
        .section { display: none; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .section.active { display: block; animation: fadeIn 0.3s; }

        /* Knowledge & Tables */
        .k-item { border: 1px solid #e2e8f0; border-radius: 10px; margin-bottom: 10px; }
        .k-header { background: #f1f5f9; padding: 15px; cursor: pointer; font-weight: bold; display: flex; justify-content: space-between; border-radius: 10px; }
        .k-content { padding: 20px; display: none; border-top: 1px solid #e2e8f0; line-height: 1.8; }
        .k-content.show { display: block; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 0.85em; }
        th, td { border: 1px solid #e2e8f0; padding: 10px; text-align: left; }
        th { background: #eff6ff; }

        /* Flashcard 3D */
        .fc-wrapper { perspective: 1000px; width: 300px; height: 180px; margin: 20px auto; cursor: pointer; }
        .fc-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; }
        .fc-inner.flipped { transform: rotateY(180deg); }
        .fc-front, .fc-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold; border-radius: 15px; padding: 15px; box-sizing: border-box; }
        .fc-front { background: linear-gradient(135deg, #3b82f6, #1e40af); color: white; }
        .fc-back { background: #16a34a; color: white; transform: rotateY(180deg); }

        /* Quiz/Test */
        .question-block { padding: 15px; border-radius: 10px; border: 2px solid #f1f5f9; margin-bottom: 15px; }
        .unanswered { border-color: var(--warning); background-color: #fffbeb; }
        .btn { background: var(--primary); color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; margin: 5px; }
        .btn-reset { background: #64748b; }
        .result-box { display: none; margin: 20px 0; padding: 20px; border-radius: 10px; text-align: center; font-weight: bold; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<header>
    <h1>ENGLISH PRACTICING</h1>
    <p>All-in-One: Grammar, Tenses, Flashcards & History</p>
</header>

<nav>
    <button onclick="showTab('home')" class="nav-btn active">Ki·∫øn Th·ª©c</button>
    <button onclick="showTab('flashcard')" class="nav-btn">Flashcard</button>
    <button onclick="showTab('quiz')" class="nav-btn">Luy·ªán T·∫≠p</button>
    <button onclick="showTab('test')" class="nav-btn">Ki·ªÉm Tra</button>
    <button onclick="showTab('history')" class="nav-btn">L·ªãch S·ª≠</button>
</nav>

<main>
    <div id="home" class="section active">
        <h2>üìö Th∆∞ Vi·ªán Ng·ªØ Ph√°p To√†n Di·ªán</h2>
        
        <div class="k-item">
            <div class="k-header" onclick="toggleK(this)">‚è∞ 12 Th√¨ Trong Ti·∫øng Anh <span>‚ñº</span></div>
            <div class="k-content">
                

[Image of English verb tenses timeline]

                <table>
                    <tr><th>Th√¨</th><th>C√¥ng th·ª©c</th><th>C√°ch d√πng</th></tr>
                    <tr><td>Hi·ªán t·∫°i ƒë∆°n</td><td>S + V(s/es)</td><td>Th√≥i quen, s·ª± th·∫≠t hi·ªÉn nhi√™n</td></tr>
                    <tr><td>Hi·ªán t·∫°i ti·∫øp di·ªÖn</td><td>S + am/is/are + V-ing</td><td>H√†nh ƒë·ªông ƒëang x·∫£y ra</td></tr>
                    <tr><td>Hi·ªán t·∫°i ho√†n th√†nh</td><td>S + have/has + V3/ed</td><td>Kinh nghi·ªám, k·∫øt qu·∫£ ·ªü hi·ªán t·∫°i</td></tr>
                    <tr><td>Qu√° kh·ª© ƒë∆°n</td><td>S + V2/ed</td><td>H√†nh ƒë·ªông ƒë√£ k·∫øt th√∫c trong qu√° kh·ª©</td></tr>
                    <tr><td>Qu√° kh·ª© ti·∫øp di·ªÖn</td><td>S + was/were + V-ing</td><td>H√†nh ƒë·ªông ƒëang x·∫£y ra trong qu√° kh·ª©</td></tr>
                    <tr><td>T∆∞∆°ng lai ƒë∆°n</td><td>S + will + V-inf</td><td>Quy·∫øt ƒë·ªãnh t·ª©c th·ªùi, d·ª± ƒëo√°n</td></tr>
                </table>
            </div>
        </div>

        <div class="k-item">
            <div class="k-header" onclick="toggleK(this)">üåø C√¢u ƒêi·ªÅu Ki·ªán (Conditionals) <span>‚ñº</span></div>
            <div class="k-content">
                
                <p><b>Lo·∫°i 0:</b> If + HTƒê, HTƒê (S·ª± th·∫≠t hi·ªÉn nhi√™n)</p>
                <p><b>Lo·∫°i 1:</b> If + HTƒê, S + will + V-inf (C√≥ th·ªÉ x·∫£y ra ·ªü hi·ªán t·∫°i/t∆∞∆°ng lai)</p>
                <p><b>Lo·∫°i 2:</b> If + QKƒê, S + would + V-inf (Gi·∫£ ƒë·ªãnh tr√°i th·ª±c t·∫ø hi·ªán t·∫°i)</p>
                <p><b>Lo·∫°i 3:</b> If + QKHT, S + would have + V3/ed (Gi·∫£ ƒë·ªãnh tr√°i th·ª±c t·∫ø qu√° kh·ª©)</p>
            </div>
        </div>

        <div class="k-item">
            <div class="k-header" onclick="toggleK(this)">üì¢ C√¢u M·ªánh L·ªánh (Imperatives) <span>‚ñº</span></div>
            <div class="k-content">
                <p><b>Kh·∫≥ng ƒë·ªãnh:</b> V-inf + (O)! (V√≠ d·ª•: <i>Close the door!</i>)</p>
                <p><b>Ph·ªß ƒë·ªãnh:</b> Don't + V-inf + (O)! (V√≠ d·ª•: <i>Don't touch that!</i>)</p>
                <p><b>L·ªãch s·ª±:</b> Th√™m "Please" v√†o ƒë·∫ßu ho·∫∑c cu·ªëi c√¢u.</p>
            </div>
        </div>

        <div class="k-item">
            <div class="k-header" onclick="toggleK(this)">üí° 360 ƒê·ªông t·ª´ b·∫•t quy t·∫Øc (Tra c·ª©u) <span>‚ñº</span></div>
            <div class="k-content">
                <input type="text" style="width:100%; padding:10px; margin-bottom:10px;" placeholder="T√¨m t·ª´..." onkeyup="searchVerbs(this)">
                <div style="max-height:300px; overflow-y:auto;">
                    <table id="verbTable">
                        <thead><tr><th>V1</th><th>V2</th><th>V3</th><th>Nghƒ©a</th></tr></thead>
                        <tbody id="verbBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="flashcard" class="section">
        <h2>üóÇÔ∏è Vocabulary Flashcards</h2>
        <div class="fc-wrapper" onclick="this.querySelector('.fc-inner').classList.toggle('flipped')">
            <div class="fc-inner">
                <div class="fc-front" id="fc-front">Word</div>
                <div class="fc-back" id="fc-back">Nghƒ©a</div>
            </div>
        </div>
        <div style="text-align: center;">
            <button class="btn" onclick="nextCard()">T·ª´ ti·∫øp theo ‚û°</button>
        </div>
    </div>

    <div id="quiz" class="section">
        <h2>üìù Luy·ªán T·∫≠p Ng·∫´u Nhi√™n</h2>
        <div id="quiz-area"></div>
        <button class="btn" onclick="grade('quiz')">N·ªôp B√†i</button>
        <button class="btn btn-reset" onclick="initQuiz()">ƒê·ªÅ m·ªõi ‚Üª</button>
        <div id="quiz-result" class="result-box"></div>
    </div>

    <div id="test" class="section">
        <h2>‚è±Ô∏è Ki·ªÉm Tra T·ªïng H·ª£p</h2>
        <div id="test-area"></div>
        <button class="btn" onclick="grade('test')">N·ªôp B√†i</button>
        <button class="btn btn-reset" onclick="initTest()">ƒê·ªÅ m·ªõi ‚Üª</button>
        <div id="test-result" class="result-box"></div>
    </div>

    <div id="history" class="section">
        <h2>üìà L·ªãch s·ª≠ h·ªçc t·∫≠p</h2>
        <ul id="historyList" style="padding:0; list-style:none;"></ul>
        <button class="btn btn-reset" onclick="clearHistory()">X√≥a l·ªãch s·ª≠</button>
    </div>
</main>

<script>
    const verbs = [
        {v1:"go", v2:"went", v3:"gone", m:"ƒëi"}, {v1:"be", v2:"was/were", v3:"been", m:"th√¨,l√†,·ªü"},
        {v1:"do", v2:"did", v3:"done", m:"l√†m"}, {v1:"see", v2:"saw", v3:"seen", m:"nh√¨n th·∫•y"}
    ];

    const flashcards = [
        {f: "Imperative", b: "C√¢u m·ªánh l·ªánh (y√™u c·∫ßu, ra l·ªánh)"},
        {f: "Conditional Type 1", b: "N·∫øu HTƒê, s·∫Ω + V-inf"},
        {f: "Present Perfect", b: "Di·ªÖn t·∫£ h√†nh ƒë·ªông v·ª´a m·ªõi x·∫£y ra"},
        {f: "Sustainable", b: "B·ªÅn v·ªØng, c√≥ th·ªÉ duy tr√¨"}
    ];

    const questions = [
        {q: "If it rains, we _____ at home.", o: ["stay", "will stay", "would stay", "stayed"], a: 1},
        {q: "_____ the window, please! It's cold.", o: ["To close", "Closed", "Close", "Closing"], a: 2},
        {q: "She _____ her homework yet.", o: ["doesn't finish", "didn't finish", "hasn't finished", "isn't finishing"], a: 2},
        {q: "Don't _____ in the library!", o: ["talk", "talking", "talked", "to talk"], a: 0},
        {q: "If I _____ a bird, I would fly.", o: ["am", "was", "been", "were"], a: 3}
    ];

    let fcIdx = 0;
    let qQuiz = [], qTest = [];

    window.onload = () => {
        loadVerbs();
        updateCard();
        initQuiz();
        initTest();
        showHistory();
    };

    function toggleK(h) { h.nextElementSibling.classList.toggle('show'); }

    function loadVerbs() {
        document.getElementById('verbBody').innerHTML = verbs.map(v => 
            `<tr><td><b>${v.v1}</b></td><td>${v.v2}</td><td>${v.v3}</td><td>${v.m}</td></tr>`).join('');
    }

    function searchVerbs(el) {
        let val = el.value.toLowerCase();
        let rows = document.getElementById('verbBody').getElementsByTagName('tr');
        for (let r of rows) r.style.display = r.textContent.toLowerCase().includes(val) ? "" : "none";
    }

    function updateCard() {
        document.getElementById('fc-front').innerText = flashcards[fcIdx].f;
        document.getElementById('fc-back').innerText = flashcards[fcIdx].b;
        document.querySelector('.fc-inner').classList.remove('flipped');
    }

    function nextCard() { fcIdx = (fcIdx + 1) % flashcards.length; updateCard(); }

    function initQuiz() { qQuiz = getRandom(5); renderQs('quiz-area', qQuiz, 'q'); }
    function initTest() { qTest = getRandom(5); renderQs('test-area', qTest, 't'); }
    function getRandom(n) { return [...questions].sort(() => 0.5 - Math.random()).slice(0, n); }

    function renderQs(id, data, pre) {
        document.getElementById(id).innerHTML = data.map((item, i) => `
            <div class="question-block" id="${pre}-b-${i}">
                <strong>${i+1}. ${item.q}</strong>
                <div style="margin-top:10px;">
                    ${item.o.map((opt, idx) => `<label style="display:block; padding:5px;"><input type="radio" name="${pre}-${i}" value="${idx}"> ${opt}</label>`).join('')}
                </div>
                <div id="${pre}-f-${i}" style="margin-top:5px; font-weight:bold;"></div>
            </div>`).join('');
    }

    function grade(type) {
        const data = type === 'quiz' ? qQuiz : qTest;
        const pre = type === 'quiz' ? 'q' : 't';
        let score = 0, complete = true;

        data.forEach((item, i) => {
            const sel = document.querySelector(`input[name="${pre}-${i}"]:checked`);
            const block = document.getElementById(`${pre}-b-${i}`);
            block.classList.remove('unanswered');
            if(!sel) { block.classList.add('unanswered'); complete = false; }
            else if(parseInt(sel.value) === item.a) score++;
        });

        if(complete) {
            const res = document.getElementById(`${type}-result`);
            res.style.display = "block";
            res.innerText = `ƒêi·ªÉm: ${score}/${data.length}`;
            saveHistory(type.toUpperCase(), `${score}/${data.length}`);
        } else {
            alert("Vui l√≤ng ho√†n th√†nh c√°c c√¢u m√†u v√†ng!");
        }
    }

    function saveHistory(type, score) {
        let history = JSON.parse(localStorage.getItem('eng_prac_history')) || [];
        history.unshift({type, score, date: new Date().toLocaleString('vi-VN')});
        localStorage.setItem('eng_prac_history', JSON.stringify(history.slice(0, 10)));
        showHistory();
    }

    function showHistory() {
        let history = JSON.parse(localStorage.getItem('eng_prac_history')) || [];
        document.getElementById('historyList').innerHTML = history.map(h => 
            `<li style="padding:10px; border-bottom:1px solid #eee; display:flex; justify-content:space-between;">
                <span><b>${h.type}</b>: ${h.score}</span><small style="color:#888">${h.date}</small>
            </li>`).join('');
    }

    function clearHistory() { localStorage.removeItem('eng_prac_history'); showHistory(); }

    function showTab(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.currentTarget.classList.add('active');
    }
</script>
</body>
</html>
